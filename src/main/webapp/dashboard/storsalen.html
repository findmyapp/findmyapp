<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<meta name="robots" content="noindex" />
<title>UKA 2011</title>
<script type="text/javascript" src="ajaxobject.js"></script>
<script type="text/javascript" src="dateformat.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="dataclient.js"></script>
<link rel="stylesheet" href="ukaStatsStylesheet.css" />
<link rel="stylesheet" href="ceciliestyle.css" />
<script type="text/javascript">
    
    //google.load("visualization", "1", {packages:["corechart"]});
    //google.setOnLoadCallback(getData(2,"beersale"));
    
   	var todaysEvents;
   	var tomorrowsEvents;
    
    window.onload = function(){
    	var url = 'http://localhost:8080/findmyapp/program/uka11/places/storsalen';
    	var request = new ajaxObject(url, processEvents);
    	request.update();  // Server is contacted here
    	
    	url = 'http://localhost:8080/findmyapp/program/uka11/places/dodensdal';
    	request = new ajaxObject(url, processTomorrowsEvents);
    	request.update();  // Server is contacted here
    }
    
	function processEvents(responseText, responseStatus){
		
		var row;
		var cell;
		
		if (responseStatus==200) {
  		
			console.log(responseText);
  		  	todaysEvents = eval(responseText);
  		  	
  		    var table = document.getElementById ("event-table-today");
	  		var i=0;
	  		
	  		console.log('no of events: ' + todaysEvents.length)
			for(i=0; i<todaysEvents.length; i++) {
				
				row = table.insertRow (-1);
				var arg = "showEvent(" + i +");";
		        row.setAttribute("onClick",arg);
		        
		        cell = row.insertCell (0);
		        var date = new Date(todaysEvents[i].showingTime); 
		        console.log(date);
		        cell.innerHTML = date.format("HH:MM"); 
		        
		        cell = row.insertCell (1);
		       	cell.innerHTML = todaysEvents[i].title;
		       	
			}
		}
	}
	
	function processTomorrowsEvents(responseText, responseStatus){
		
		var row;
		var cell;
		
		if (responseStatus==200) {
  		
			console.log(responseText);
			tomorrowsEvents = eval(responseText);
  		  	
  		    var table = document.getElementById ("event-table-tomorrow");
	  		var i=0;
	  		
	  		console.log('no of events: ' + tomorrowsEvents.length)
			for(i=0; i<tomorrowsEvents.length; i++) {
				
				row = table.insertRow (-1);
				var arg = "showTomorrowsEvent(" + i +");";
		        row.setAttribute("onClick",arg);
		        
		        cell = row.insertCell (0);
		        var date = new Date(tomorrowsEvents[i].showingTime); 
		        console.log(date);
		        cell.innerHTML = date.format("HH:MM"); 
		        
		        cell = row.insertCell (1);
		       	cell.innerHTML = tomorrowsEvents[i].title;
		       	
			}
		}
	}
	
	function showtodaysEventsPage() {
		//var div = document.getElementById ("middle-div");
		//var title = "<p>" + Storsalen er selve hjertet av Samfundet. Lokalet har gjestet alt fra Dalai Lama til Sex Pistols â€“ og det meste i mellom. + "</p>"
		//div.innerHTML = title;
	}
	
	
	function showEvent(index) {
		
		console.log("showing event with index: " + index);
		var div = document.getElementById ("middle-div");
		div.innerHTML = "";
		var h1 = document.createElement("h1");
		h1.innerHTML = todaysEvents[index].title;
		div.appendChild(h1);
		var p = document.createElement("p");
		p.innerHTML = todaysEvents[index].lead;
		div.appendChild(p);
		
	}

	function showTomorrowsEvent(index) {
		
		console.log("showing event with index: " + index);
		var div = document.getElementById ("middle-div");
		div.innerHTML = "";
		var h1 = document.createElement("h1");
		h1.innerHTML = tomorrowsEvents[index].title;
		div.appendChild(h1);
		var p = document.createElement("p");
		p.innerHTML = tomorrowsEvents[index].lead;
		div.appendChild(p);
		
	}
    </script>

</head>

<body>
	<header>
		<h1 id="findMyApp">FindMyApp</h1>
	</header>

	<div id="content">

		<aside id="left_aside">
			<section>
				<table class='event-table' id='event-table-today'>
					<tr class='event-table-header'>
						<th colspan="2">I dag</th>
					</tr>
				</table>

				<table class='event-table' id='event-table-tomorrow'>
					<tr class='event-table-header'>
						<th colspan="2">I morgen</th>
					</tr>
				</table>
			</section>
		</aside>

		<div id="middle-div"></div>


	</div>

</body>
</html>